<!doctype html>
<html>
<title>Flaskr</title>
<link rel=stylesheet type=text/css href="../style.css">
<script src="../jquery.js"></script>
<script src="../mustache.js"></script>
<script src="../mine.js"></script>
    

<script>

var BASE_URL = "http://127.0.0.1:5000/api/1.0";
var TEMPLATE_URL = "http://127.0.0.1:5000/static/site/templates/";
    
function getEntry(id){
    
    var uri = BASE_URL + '/entries/' + id;
    
    ajax(uri, "get")
        .done(function(data) {
            $("#content").html(render_template(TEMPLATE_URL + "entry.mustache", data));
        });
}

function getEntries(){
    
    var uri = BASE_URL + '/entries/';

    ajax(uri, "get")
        .done(function(data){
            $( "#content" ).html(render_template(TEMPLATE_URL + "entries.mustache", data));
            
            $("form#add_entry").submit(function(event){
                event.preventDefault();
                postEntry(form_to_dict(this));
                return true;
            });

        });
}

function postEntry(dic){
    
    var uri = BASE_URL + '/entries/';
    
    ajax(uri, "post", dic)
        .done(function(data){
            getEntries();
        });
}
    
function putEntry(dic){
    
    var uri = BASE_URL + '/entries/3';
    
    ajax(uri, "put", dic)
        .done(function(data){
            $( "#content" ).html("atualizando um entry: " + data.result);
        });
}
    
function deleteEntry(){
    
    var uri = BASE_URL + '/entries/2';
    
    ajax(uri, "delete")
        .done(function(data){
            $( "#content" ).html("deletando um entry: " + data.result);
        });
}
    
$( document ).ready(function() {

    if(getParameter("id") != null){
        getEntry(getParameter("id"));
    } else {
        getEntries();
    }

    console.log( "document loaded" );
});
    

</script>

<body>
    
    <input type="button" value="put entry" onclick="putEntry()">
    <input type="button" value="delete entry" onclick="deleteEntry()">
    
    <div class=page>
        
        <h1>Flaskr</h1>

        <div id="content">
        </div>
    </div>

</body>
</html>